<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sky Dreamers – Live Ops Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
  margin:0;
  font-family:Inter,Segoe UI,Arial;
  background:#0f172a;
  color:#e5e7eb;
}
header{
  padding:16px;
  font-size:22px;
  font-weight:700;
}
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:14px;
  padding:0 16px;
}
.card{
  background:#1f2937;
  border-radius:14px;
  padding:16px;
  text-align:center;
}
.card h2{margin:0;font-size:32px}
.card span{font-size:12px;color:#9ca3af}
.main{
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:16px;
  padding:16px;
}
.panel{
  background:#111827;
  border-radius:14px;
  padding:14px;
}
table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}
th,td{
  padding:6px;
  text-align:center;
}
td.name{text-align:left;font-weight:700}
tr{border-bottom:1px solid rgba(255,255,255,.08)}
.states{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(70px,1fr));
  gap:8px;
}
.state{
  background:#020617;
  border-radius:8px;
  padding:8px;
  text-align:center;
  font-size:12px;
}
footer{
  text-align:center;
  font-size:11px;
  color:#9ca3af;
  padding:12px;
}
</style>
</head>

<body>

<header>Sky Dreamers • Live Performance</header>

<div class="cards">
  <div class="card"><h2 id="submissions">0</h2><span>Submissions</span></div>
  <div class="card"><h2 id="qualified">0</h2><span>Qualified</span></div>
  <div class="card"><h2 id="notQualified">0</h2><span>Not Qualified</span></div>
  <div class="card"><h2 id="pending">0</h2><span>Pending</span></div>
  <div class="card"><h2 id="fph">0.00</h2><span>FPH</span></div>
  <div class="card"><h2 id="sph">0.00</h2><span>SPH</span></div>
</div>

<div class="main">
  <div class="panel">
    <h3>Agents</h3>
    <table>
      <thead>
        <tr>
          <th>Agent</th><th>Subs</th><th>Qual</th><th>FPH</th><th>SPH</th><th>Avg TT</th>
        </tr>
      </thead>
      <tbody id="agents"></tbody>
    </table>
  </div>

  <div>
    <div class="panel">
      <h3>Campaigns</h3>
      <table>
        <thead>
          <tr>
            <th>Campaign</th><th>Subs</th><th>Qual</th><th>FPH</th>
          </tr>
        </thead>
        <tbody id="campaigns"></tbody>
      </table>
    </div>

    <div class="panel" style="margin-top:12px">
      <h3>States</h3>
      <div class="states" id="states"></div>
    </div>
  </div>
</div>

<footer>Sky Dreamers © 2025</footer>

<script>
firebase.initializeApp({
  databaseURL:"https://performance-dashboard-c7017-default-rtdb.firebaseio.com"
});

firebase.database().ref("dashboard/live").on("value", snap => {
  const d = snap.val();
  if (!d || !d.summary) return;

  submissions.innerText = d.summary.submissions;
  qualified.innerText = d.summary.qualified;
  notQualified.innerText = d.summary.notQualified;
  pending.innerText = d.summary.pending;
  fph.innerText = d.summary.fph.toFixed(2);
  sph.innerText = d.summary.sph.toFixed(2);

  renderAgents(d.agents || {});
  renderCampaigns(d.campaigns || {});
  renderStates(d.states || {});
});

function renderAgents(a){
  agents.innerHTML="";
  Object.entries(a).forEach(([n,v])=>{
    agents.innerHTML+=`
      <tr>
        <td class="name">${n}</td>
        <td>${v.submissions}</td>
        <td>${v.qualified}</td>
        <td>${v.fph.toFixed(2)}</td>
        <td>${v.sph.toFixed(2)}</td>
        <td>${fmt(v.avgTalkTime)}</td>
      </tr>`;
  });
}
function renderCampaigns(c){
  campaigns.innerHTML="";
  Object.entries(c).forEach(([n,v])=>{
    campaigns.innerHTML+=`
      <tr>
        <td class="name">${n}</td>
        <td>${v.submissions}</td>
        <td>${v.qualified}</td>
        <td>${v.fph.toFixed(2)}</td>
      </tr>`;
  });
}
function renderStates(s){
  states.innerHTML="";
  Object.entries(s).forEach(([k,v])=>{
    states.innerHTML+=`<div class="state">${k}<br><b>${v}</b></div>`;
  });
}
function fmt(sec){
  if(!sec) return "0:00";
  return Math.floor(sec/60)+":"+String(sec%60).padStart(2,"0");
}
</script>

</body>
</html>
